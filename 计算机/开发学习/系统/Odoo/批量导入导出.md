# ğŸŒ Odoo æ•°æ®æ‰¹é‡å¯¼å…¥ä¸å¯¼å‡º

---

## 1. æ ¸å¿ƒæ¦‚å¿µ

- **æ‰¹é‡æ“ä½œ**ï¼šä¸€æ¬¡æ€§å¤„ç†å¤šæ¡è®°å½•ï¼Œé¿å…å¾ªç¯å•æ¡æ“ä½œï¼Œæé«˜æ€§èƒ½
    
- **å¯ç”¨æ¥å£**ï¼š
    
    1. XML-RPC
        
    2. JSON-RPC
        
    3. è‡ªå®šä¹‰ RESTful API
        
- **å¸¸ç”¨åœºæ™¯**ï¼š
    
    - å¯¼å…¥å®¢æˆ·ã€äº§å“ã€è®¢å•
        
    - å¯¼å‡ºé”€å”®æ•°æ®ã€åº“å­˜æ•°æ®
        
    - ç¬¬ä¸‰æ–¹ç³»ç»Ÿæ•°æ®åŒæ­¥
        

---

## 2. æ‰¹é‡å¯¼å…¥æ•°æ®

### 2.1 XML-RPC ç¤ºä¾‹

```
import xmlrpc.client

url = 'http://localhost:8069'
db = 'odoo_db'
username = 'admin'
password = 'admin'

common = xmlrpc.client.ServerProxy(f'{url}/xmlrpc/2/common')
uid = common.authenticate(db, username, password, {})

models = xmlrpc.client.ServerProxy(f'{url}/xmlrpc/2/object')

# æ‰¹é‡åˆ›å»ºå®¢æˆ·
customers = [
    {'name': 'Alice', 'email': 'alice@example.com'},
    {'name': 'Bob', 'email': 'bob@example.com'},
    {'name': 'Charlie', 'email': 'charlie@example.com'},
]

customer_ids = models.execute_kw(db, uid, password,
    'res.partner', 'create', customers)  # æ³¨æ„ï¼šéƒ¨åˆ†ç‰ˆæœ¬å¯èƒ½éœ€è¦å¾ªç¯ create

```

> âš ï¸ å°æç¤ºï¼šéƒ¨åˆ† Odoo ç‰ˆæœ¬ `create` åªèƒ½å•æ¡æ“ä½œï¼Œå¯é€šè¿‡å¾ªç¯æˆ–è‡ªå®šä¹‰æ–¹æ³•æ‰¹é‡åˆ›å»ºã€‚

---

### 2.2 JSON-RPC ç¤ºä¾‹

```
import requests
import json

url = 'http://localhost:8069/jsonrpc'
db = 'odoo_db'
username = 'admin'
password = 'admin'

# ç™»å½•è·å– uid
payload = {
    "jsonrpc": "2.0",
    "method": "call",
    "params": {"service": "common", "method": "login", "args": [db, username, password]},
    "id": 1
}
uid = requests.post(url, json=payload).json()['result']

# æ‰¹é‡åˆ›å»º
customers = [
    {'name': 'Alice', 'email': 'alice@example.com'},
    {'name': 'Bob', 'email': 'bob@example.com'},
]

payload = {
    "jsonrpc": "2.0",
    "method": "call",
    "params": {
        "service": "object",
        "method": "execute_kw",
        "args": [db, uid, password, 'res.partner', 'create', customers]
    },
    "id": 2
}
response = requests.post(url, json=payload).json()

```

---

### 2.3 è‡ªå®šä¹‰ RESTful API æ‰¹é‡å¯¼å…¥

```
from odoo import http
from odoo.http import request

class CustomerController(http.Controller):

    @http.route('/api/customers/batch', type='json', auth='user', methods=['POST'], csrf=False)
    def create_customers(self):
        data = request.jsonrequest  # [{"name":"Alice"}, {"name":"Bob"}]
        created_ids = []
        for item in data:
            partner = request.env['res.partner'].sudo().create(item)
            created_ids.append(partner.id)
        return {"status": "success", "ids": created_ids}

```

- æ¥å£æ¥å— **JSON æ•°ç»„**ï¼Œæ‰¹é‡åˆ›å»ºå®¢æˆ·
    
- è¿”å›åˆ›å»ºçš„ ID åˆ—è¡¨
    

---

## 3. æ‰¹é‡å¯¼å‡ºæ•°æ®

### 3.1 XML-RPC / JSON-RPC ç¤ºä¾‹

```
# æœç´¢å¹¶è¯»å–å¤šä¸ªå­—æ®µ
partner_ids = models.execute_kw(db, uid, password,
    'res.partner', 'search', [[['is_company', '=', True]]])

partners_data = models.execute_kw(db, uid, password,
    'res.partner', 'read',
    [partner_ids], {'fields': ['name', 'email', 'phone']})

```

- `search` è¿”å›ç¬¦åˆæ¡ä»¶çš„ ID åˆ—è¡¨
    
- `read` æ‰¹é‡è¯»å–å­—æ®µï¼Œè¿”å›å­—å…¸åˆ—è¡¨
    

### 3.2 è‡ªå®šä¹‰ RESTful API å¯¼å‡º

```
@http.route('/api/customers/export', type='json', auth='user', methods=['GET'])
def export_customers(self):
    partners = request.env['res.partner'].sudo().search([])
    data = []
    for p in partners:
        data.append({
            "name": p.name,
            "email": p.email,
            "phone": p.phone,
        })
    return {"status": "success", "data": data}

```

- è¿”å› JSON æ•°ç»„ï¼Œä¾›ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¯¼å…¥
    
- å¯é…åˆåˆ†é¡µã€è¿‡æ»¤æ¡ä»¶ä¼˜åŒ–æ€§èƒ½
    

---

## 4. æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–

1. **ä½¿ç”¨ ORM æ‰¹é‡æ–¹æ³•**
    
    - `create([{}, {}])` ä¸€æ¬¡æ’å…¥å¤šæ¡è®°å½•
        
    - `write([{}])` æ‰¹é‡æ›´æ–°è®°å½•é›†
        
    - `search_read()` ä¸€æ¬¡æœç´¢å¹¶è¯»å–å­—æ®µ
        
2. **é¿å…å¾ªç¯å†…é‡å¤æŸ¥è¯¢**
    
3. **åˆ†é¡µå¯¼å‡ºå¤§æ•°æ®**
    
    `partners = env['res.partner'].search([], limit=100, offset=0)`
    
4. **ä½¿ç”¨ `sudo()` æˆ–ä¸“ç”¨ API ç”¨æˆ·æƒé™**
    

---

## 5. å®é™…åº”ç”¨åœºæ™¯

|åœºæ™¯|æ–¹æ³•|è¯´æ˜|
|---|---|---|
|å¯¼å…¥å®¢æˆ·|XML-RPC / JSON-RPC / REST API|æ‰¹é‡åˆ›å»ºæˆ–æ›´æ–°å®¢æˆ·|
|å¯¼å…¥è®¢å•|REST API|æ¥æ”¶ç¬¬ä¸‰æ–¹ç³»ç»Ÿ JSON æ•°æ®|
|å¯¼å‡ºé”€å”®æ•°æ®|XML-RPC / JSON-RPC / REST API|æ‰¹é‡è¯»å–å¹¶ä¼ ç»™æŠ¥è¡¨ç³»ç»Ÿ|
|ç§»åŠ¨ç«¯åŒæ­¥|REST API|æ‰¹é‡æ‹‰å–å®¢æˆ·ã€è®¢å•ã€åº“å­˜|
|æ•°æ®è¿ç§»|XML-RPC + Python è„šæœ¬|æ‰¹é‡è¿ç§»æ—§ç³»ç»Ÿæ•°æ®|

---

## 6. æ³¨æ„äº‹é¡¹

- **å®‰å…¨æ€§**ï¼š
    
    - æ‰¹é‡æ¥å£å»ºè®®ä½¿ç”¨ Token / OAuth2 æˆ–ä¸“ç”¨ API ç”¨æˆ·
        
    - é¿å…æš´éœ²æ•æ„Ÿæ¨¡å‹
        
- **æ€§èƒ½**ï¼š
    
    - é¿å…ä¸€æ¬¡æ€§æ“ä½œè¿‡å¤§æ•°æ®ï¼Œåˆ†é¡µå¤„ç†
        
- **æ•°æ®æ ¡éªŒ**ï¼š
    
    - å¿…é¡»éªŒè¯è¾“å…¥å­—æ®µå’Œæ ¼å¼
        
    - ä½¿ç”¨äº‹åŠ¡ï¼ˆORM è‡ªåŠ¨æ”¯æŒï¼‰é¿å…éƒ¨åˆ†å¯¼å…¥å¤±è´¥
        

---

## 7. æ€»ç»“

- **æ‰¹é‡å¯¼å…¥/å¯¼å‡ºæ ¸å¿ƒæ­¥éª¤**ï¼š
    
    1. ç™»å½•è®¤è¯ï¼ˆXML-RPC / JSON-RPC / REST APIï¼‰
        
    2. æ‰¹é‡åˆ›å»º / æ›´æ–° / æŸ¥è¯¢è®°å½•
        
    3. è¿”å›ç»“æœæˆ– JSON æ•°æ®
        
- **æ¥å£é€‰æ‹©**ï¼š
    
    - XML-RPC / JSON-RPCï¼šä¼ ç»Ÿè„šæœ¬æˆ–è·¨è¯­è¨€ç³»ç»Ÿ
        
    - RESTful APIï¼šç°ä»£ Web / ç§»åŠ¨ç«¯ç³»ç»Ÿ
        
- **æ€§èƒ½ä¼˜åŒ–**ï¼š
    
    - ä½¿ç”¨ ORM æ‰¹é‡æ–¹æ³•
        
    - åˆ†é¡µå¯¼å‡ºå¤§æ•°æ®
        
    - ä½¿ç”¨äº‹åŠ¡å’Œ sudo æ§åˆ¶æƒé™